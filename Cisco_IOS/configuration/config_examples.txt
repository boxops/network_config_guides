### Cisco_IOS ###


### Configure Hostname

conf t
hostname R1
do sh run | inc host


### Configure Interface with IP address

interface FastEthernet0/0
ip address 10.1.1.1 255.255.255.0
no shutdown


### Set Up an IOS Router or Switch as SSH Client

# There are four steps required to enable SSH support on a Cisco IOS:

# 1. Configure the hostname command.
# 2. Configure the DNS domain.
# 3. Generate the SSH key to be used.
# 4. Enable SSH transport support for the virtual type terminal (vtys).

configure terminal
hostname R1
ip domain name cisco.com
username admin privilege 15 password Cisco123
line con 0
password cisco
login
exit
line vty 0 4
password cisco
login local
logging synchronous
transport input all
exit
line vty 5 15
password cisco
login local
logging synchronous
transport input all
exit
crypto key generate rsa
1024
ip ssh version 2
banner motd # Unauthorised access is strictly prohibited! #
end
wr


### Standard ACL

# access-list number { deny | permit } ip wildcard-mask
access-list 1 deny 1.1.1.1 0.0.0.0
access-list 1 deny 1.1.1.1
access-list 1 deny host 1.1.1.1
access-list 1 permit any
access-list 1 permit 0.0.0.0 255.255.255.255
access-list 1 remark ## BLOCK PERSON FROM ACCOUNTING ##

show access-lists
show ip access-lists

# Permit a single host from a subnet
access-list 1 permit 192.168.1.1
access-list 1 deny 192.168.1.0 0.0.0.255
interface g0/1
ip access-group 1 out

# Named ACL
ip access-list standard { acl-name }
[ entry number ] { deny | permit } ip wildcard-mask


### Better ACL Config

# Standard ACL
# Numbered ACL Ranges: 100-199, 2000-2699

ip access-list standard 1
# or
ip access-list standard BLOCK_PC1
deny 192.168.1.1
permit any
do show access list
# delete an entry
no 30

# insert a new entry by specifying the sequence number
30 deny 192.168.2.0 0.0.0.255

# resequence ACLs
# ip access-list resequence [acl-id] [starting-seq-num] [increment]
# [starting-seq-num] = change the sequence number of the first entry to 10
# [increment] = add 10 for every entry after that
ip access-list resequence 1 10 10

# NOTE - When configuring or editing numbered ACLs from global config mode,
# you cannot delete individual entries, you can only delete the entire ACL!


### Extended ACLs

# Extendend Numbered ACL
# access-list [number] (permit | deny) [protocol] [src-ip] [dest-ip]

# Extended Named ACL
# ip access-list extended (name | number)
# [seq-num] (permit | deny) [protocol] [src-ip] [dest-ip]
ip acccess-list extended DENY_VLAN10
deny tcp any 10.0.0.0 0.0.0.255

# examples
# allow all traffic
permit ip any any
# prevent 10.0.0.0/16 from sending UDP traffic to 192.168.1.1/32
deny udp 10.0.0.0 0.0.255.255 host 192.168.1.1
# prevent 172.16.1.1/32 from pinging hosts in 192.168.0.0/24
deny icmp host 172.16.1.1 192.168.0.0 0.0.0.255
# When matching TCP or UDP, you can optionally specify the source and/or destination port numbers to match
deny tcp [src-ip] eq [src-port-num] [dest-ip]
deny tcp 10.1.1.1 eq 80 10.2.2.2
# eq 80 = equal to port 80
# gt 80 = greater than 80 (<81)
# lt 80 = less than 80 (>79)
# neq 80 = NOT 80
# range 80 100 = port from 80 to port 100

# After the destination IP address and/or port numbers, there are more options you can use to match
# ack = match TCP ACK flag
# fin = match TCP FIN flag
# syn = match TCP SYN flag
# ttl = match packets with a specific TTL value
# dscp = match packets with a specific DSCP value

# examples
# allow traffic from 10.0.0.0/16 to access the server at 2.2.2.2/32 using HTTPS
permit tcp 10.0.0.0 0.0.255.255 2.2.2.2 0.0.0.0 eq 443
# prevent all hosts using source UDP port numbers from 20000 to 30000 from accessing the server at 3.3.3.3/32
deny udp any range 20000 30000 host 3.3.3.3
# allow hosts in 172.16.1.0/24 using a TCP source port greater than 9999 to access all TCP ports on server 4.4.4.4/32 except port 23
permit tcp 172.16.1.0 0.0.0.255 gt 9999 host 4.4.4.4 neq 23

# Applying Extended ACLs to interfaces
# Note - Extended ACLs should be applied as close to the soruce as possible to limit how far the packets travel in the network before being denied. Standard ACLs are less specific, so if they are applied close to the source there is a risk of blocking more than intended.

interface g0/1
ip access-group HTTP_SRV1 in

# Prevent R1 from forwarding OSPF packets out of G0/2
ip access-list extended 112
deny 89 any any
permit ip any any
interface g0/2
ip access-group 112 out


### Static Routing

# ip route [ remote network ] [ remote network subnet ] [ neighbour interface ]
ip route 10.1.1.0 255.255.255.0 10.1.2.1

### OSPF Dynamic Routing

OSPF Neighbour Requirements

1. Area must match
2. Area must be in the same subnet
3. OSPF process must not be sutdown
4. OSPF Router IDs must be unique
5. Hello and Dead timers must match
6. Autohentication settings must match
7. IP MTU settings must match
8. OSPF Network Type must match


OSPF Types of LSA

Type 1 (Router LSA)
- Every OSPF rotuer generates this type of LSA.
- It identifies the router using its router ID.
- It also lists networks attached to the rotuer's OSPF-activated interfaces.

Type 2 (Network LSA)
- Generated by the DR of each 'multi-access' network (ie. the broadcast network type).
- Lists the routers which are attached to the multi-access network.

Type 5 (AS External LSA)
- Generated by ASBRs to describe routes to destinations outside of the AS (OSPF domain).


### Subinterfaces for Router on a Stick

# On R1
int g0/0.10
encapsulation dot1Q 10
ip address 10.0.0.62 255.255.255.192

int g0/0.20
encapsulation dot1Q 20
ip address 10.0.0.216 255.255.255.192

# On SW1
int g0/0
switchport mode trunk
exit
vlan 10
name VLAN-A
vlan 20
name VLAN-B
int f0/1
switchport mode access
switchport access vlan 10
exit
int f0/2
switchport mode access
switchport access vlan 20
exit

show vlans


### Etherchannel

# LACP SW1
int range g0/1-2
channel-group 1 mode active
exit
int po1
switchport trunk encapsulation dot1q
switchport mode trunk

# LACP SW2
int range g0/3-4
channel-group 1 mode active
exit
int po1
switchport trunk encapsulation dot1q
switchport mode trunk

# Static Etherchannel
# DSW1
int range g0/1-2
no switchport
channel-group 2 mode on
int po2
ip add 10.0.0.1 255.255.255.252

# DSW2
int range g0/1-2
no switchport
channel-group 2 mode on
int po2
ip add 10.0.0.2 255.255.255.252

show etherchannel summary

# Etherchannel load-balance
port-channel load-balance src-dst-ip

show etherchannel load-balance


### HSRP

# R1
int g0/0
standby version 2
standby 1 ip 10.0.1.254
standby 1 pirority 200
standby 1 preempt

# R2
int g0/0
standby version 2
standby 1 ip 10.0.1.254
standby 1 pirority 50

show standby


### CDP

# Enable / disable CDP globally
[no] cdp run

# Enable / disable CDP on specirfic interfaces
interface g0/1
[no] cdp enable

# Configure the CDP timer
cdp timer (seconds)

# Configure the CDP holdtime
cdp holdtime (seconds)

# Enable / disable CDPv2
[no] cdp advertise-v2

# CDP show commands
show cdp
show cdp traffic
show cdp interface
show cdp  neighbours
show cdp detail
show cdp entry (name)


### LLDP

# Enable / disable LLDP
[no] lldp run

# Enable / disable LLDP on specirfic interfaces (tx)
int g0/1
[no] lldp transmit

# Enable / disable LLDP on specirfic interfaces (rx)
int g0/1
[no] lldp receive

# Configure the LLDP timer
lldp timer (seconds)

# Configure the LLDP holdtime
lldp holdtime (seconds)

# Configure the LLDP reinit timer
lldp reinit (seconds)

# LLDP show commands
show lldp
show lldp traffic
show lldp interface
show lldp  neighbours
show lldp detail
show lldp entry (name)


### NTP

# The most important reason to have accurate time on a device
# is to have accurate logs for troubleshooting.

show clock
show clock detail
show calendar

# Manual clock configuration (Internal clocks will drift, so it is not ideal)
clock set 14:30:00 27 July 2022
clock timezone GMT 0
ntp update-calendar

# Configure NTP servers
ntp server 216.239.35.0
ntp server 216.239.35.4
ntp server 216.239.35.8
ntp server 216.239.35.12

show ntp status
show ntp associations

# NTP authentication

# R1
ntp authenticate
ntp authentication-key 1 md5 myCiscoLab
ntp trusted-key 1

# R2
ntp authenticate
ntp authentication-key 1 md5 myCiscoLab
ntp trusted-key 1
ntp server 10.0.12.1 key 1
ntp peer 10.0.23.2 key 1

# R3
ntp authenticate
ntp authentication-key 1 md5 myCiscoLab
ntp trusted-key 1
ntp server 10.0.12.1 key 1
ntp peer 10.0.23.1 key 1


### DHCP

# Configure a router to act as a DHCP Server

ip dhcp excluded-address 192.168.1.1 192.168.1.10
ip dhcp pool LAB_POOL
network 192.168.1.0 255.255.255.0
dns-server 8.8.8.8
domain-name cisco.com
default-router 192.168.1.1
# lease [days] [hours] [minutes]
lease 0 5 30
# lease infinite

show ip dhcp binding
show ip dhcp server statistics

# Configure a router to act as a DHCP Relay Agent

interface g0/1
ip helper-address 192.168.10.10

show ip interface g0/1

# Configure a router to be a DHCP Client

interface g0/1
ip address dhcp

sh ip interface g0/1


### SNMP

http://oid-info.com/

# SNMP Agent port = UDP 161
# SNMP Manager port = UDP 162

## SNMP Read Messages
# Messages sent by the NMS to read information from the managed devices.

# Get - A request sent from the manager to the agent to retrieve the value of a variable (OID), or multiple variables.
# The agent will send a Response message with the current value of each variable.

# GetNext - A request sent from the manager to the agent to discover the available variables on the MIB.

# GetBulk - A more efficient version of the GetNext message (introduced in SNMPv2).

## SNMP Write Messages
# Messages sent by the NMS to change information on the managed devices.

# Set - A request sent from the manager to the agent to change the value of one or more variables.
# The agent will send a Response message with the new values.

## SNMP Notification
# Messages sent by the managed devices to alert the NMS of a particular event.

# Trap - A notification sent from the agent to the manager. 
# The manager does not send a Response message to acknowledge that it received the Trap, so these messages are unreliable.

# Inform - A notification message that is acknowledged with a Response message.
# Originally used for communications between managers, but later updates allow agents to send Inform messages to managers too.

## SNMP Response
# Messages sent in response to a previous message/request.


## SNMPv2c Configuration

snmp-server contact example@google.com
snmp-server location "Rack B1"
snmp-server community CCNA1 ro
snmp-server community CCNA2 rw
# Specify the address of the NMS (version and which community string to use)
snmp-server host 192.168.1.1 version 2c CCNA1
# Traps will be sent if an interface goes up or down
snmp-server enable traps snmp linkdown linkup
# Traps will be sent if configuration changes are made
snmp-server enable traps config

show snmp community
show snmp contact
show snmp host
show snmp location


## SNMPv3 Configuration

Username: UserJustMe
Authentication Password: AuthPass1
Privacy Password: PrivPass2
View Name: ViewDefault
Group Name: GrpMonitoring

# IOS & IOS-XE
snmp-server view ViewDefault iso included
snmp-server group GrpMonitoring v3 priv read ViewDefault
snmp-server user UserJustMe GrpMonitoring v3 auth sha AuthPass1 priv aes 128 PrivPass2

# IOS-XR
snmp-server view ViewDefault iso included 
snmp-server group GrpMonitoring v3 priv read ViewDefault
snmp-server user UserJustMe GrpMonitoring v3 auth sha AuthPass1 priv aes 128 PrivPass2

# Nexus Switch (OS-NX)
snmp-server user UserJustMe network-admin v3 auth sha AuthPass1 priv aes-128 PrivPass2

# ASA firewall
snmp-server group GrpMonitoring v3 priv
snmp-server user UserJustMe GrpMonitoring v3 auth sha AuthPass1 priv aes 128 PrivPass2
snmp-server host mgmt 10.1.1.161 version 3 UserJustMe

# Testing SNMPv3 configuration with Net-SNMP
# apt-get install snmp
snmpwalk -v3 -l authPriv -u UserJustMe -a SHA -A AuthPass1 -x AES -X PrivPass2 10.7.1.9:161 sysDescr


### Syslog

# Syslog server port (listen) = UDP 514

# seq:time stamp: %facility-severity-MNEMONIC:description
# [sequence number]:[timestamp]: %[which process]-[severity number]-[short message]:[detailed information]

# Examples
# *Feb 11 03:02:55.304: %LINK-3-UPDOWN: Interface GigabitEthernet0/0, changed state to up
# *Feb 11 03:02:55.304: %OSPF-5-ADJCHG: Process 1, Nbr 192.168.1.2 on GigabitEthernet0/0 from LOADING to FULL, Loading Done
# *Feb 11 03:02:55.304: %SYS-5-CONFIG_I: Configured from console by admin on console
# *Feb 11 03:02:55.304: %SYS-6-CLOCKUPDATE: System clock has been updated from 07:27:23 UTC Thu Feb 11 2021 to 16:27:23 JST Thu Feb 11 2021, configured from console by admin on console.

# Syslog severity levels
# Level - Keyword - Description
# 0 - Emergency - System is unusable
# 1 - Alert - Action must be taken immediately
# 2 - Critical - Critical conditions
# 3 - Error - Error conditions
# 4 - Warning - Warning conditions
# 5 - Notice - Normal but significant conditions
# 6 - Informational - Informational messages
# 7 - Debugging - Debug-level messages

# Memorize the severity levels
# Every Awesome Cisco Engineer Will Need Icecream Daily

## Syslog Logging Locations

# Console line: Syslog messages will be displayed in the CLI when connected to the device via the console port. All messages are displayed by default.

# VTY lines: Syslog messages will be displayed in the CLI when connected to the device via Telnet or SSH. Disabled by default.

# Buffer: Syslog messages will be saved to RAM. All messages will be displayed by default.

# External server: You can configure the device to send Syslog messages to an external server.


## Syslog Configuration

# Enable console logging for the Informational severity and higher
logging console 6
# Enable logging for the Informational severity and higher
logging monitor informational
# Logging buffered [size] [level name or number]
logging buffered 8192 6
# Logging to an external server
logging 192.168.1.100
# Or: logging host 192.168.1.100
# Logging trap [level name or number]
logging trap debugging

# Enable Syslog messages when using Telnet or SSH
terminal monitor

# Print a new line when the typing is interrupted by a Syslog message (more user friendly)
line console 0
logging synchronous

# Enable timestamps for Syslog messages
service timestamp log datetime
service sequence-numbers

